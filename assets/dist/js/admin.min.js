/*!
* Package: press-tube - v0.0.3 
* Description: The easiest way to integrate YouTube in your WordPress site, with many functionality. 
* Last build: 2017-04-03 
* @author codekraft-studio 
* @license GPL2 
*/
!function(a){"use strict";a(document).ready(function(){var b=WPTUBE,c=null;a.templates('<div id="message" class="notice {{:type}}"><p>{{:message}}</p></div>'),a.templates('<div id="message" class="notice notice-error"><p>{{:errorMessage}}</p></div>');if(!a("#wt-playlist").length){var d=function(a){tinymce&&tinymce.activeEditor&&window.parent.send_to_editor(a.iframe)};a("#wt-open-frame").click(function(a){a.preventDefault(),c||(c=new window.WPTubeFrame({key:b.key,restrict:["video","playlist"],onSelect:d})),c.open()})}if(a(".wp-tube-wrap").length&&a("#playlists").length){var e={valueNames:["title","count"],page:5,pagination:!0};new List("playlists",e)}if(a("#wt-page").length){a("#wt-playlist-select").change(function(b){var c=a(this).val();""===c?(a("#wt-playlist-link").hide(),a(".options-secondary").hide()):(a("#wt-playlist-link").attr("href","https://www.youtube.com/playlist?list="+c).show(),a(".options-secondary").show())});var f=a("div.shortcode").find(".shortcode-result"),g=a("div.shortcode").find(".shortcode-options");a("div.shortcode").find(".shortcode-actions").find(".shortcode-add").click(function(a){a.preventDefault(),tinymce&&tinymce.activeEditor&&window.parent.send_to_editor(f.find("code").text())}),g.find(":input").change(function(a){return j(h())});var h=function(){return i().join(" ")},i=function(){return g.find(":input").serializeArray().filter(function(a){return a.value}).map(function(a){return a.name+'="'+a.value+'"'})},j=function(a){var b="[playlist "+a+"][/playlist]";f.find("code").text(b)};j(h())}})}(jQuery),function(a){"use strict";jQuery.expr[":"].Contains=function(a,b,c){return jQuery(a).text().toUpperCase().indexOf(c[3].toUpperCase())>=0},jQuery.expr[":"].contains=function(a,b,c){return jQuery(a).text().toUpperCase().indexOf(c[3].toUpperCase())>=0},a(document).ready(function(){if(a("#wt-playlist").length){var b=a(".playlist-item").length,c=a.templates('<div class="playlist-item unselectable"><div class="handle">{{:index}}</div><div class="playlist-thumb"><img src="{{:thumbnail}}" alt="{{:title}}"></div><div class="playlist-details"><div class="playlist-title"><h3>{{:title}}</h3><p><a class="video-channel-title" href="{{:channelUrl}}" target="_blank">{{:channelTitle}}</a> - <span class="video-date">{{:publishedAt}}</span></p></div><div class="playlist-footer"></div><div class="playlist-data hidden" style="display: none;"><input type="hidden" name="wt_playlist_items[{{:index}}][id]" value="{{:id}}" /><input type="hidden" name="wt_playlist_items[{{:index}}][title]" value="{{:title}}" /><input type="hidden" name="wt_playlist_items[{{:index}}][description]" value="{{:description}}" /><input type="hidden" name="wt_playlist_items[{{:index}}][thumbnail]" value="{{:thumbnail}}" /><input type="hidden" name="wt_playlist_items[{{:index}}][publishedAt]" value="{{:publishedAt}}" /><input type="hidden" name="wt_playlist_items[{{:index}}][channelUrl]" value="{{:channelUrl}}" /><input type="hidden" name="wt_playlist_items[{{:index}}][channelTitle]" value="{{:channelTitle}}" /></div></div><div class="playlist-item-remove"><span class="dashicons dashicons-no-alt"></span></div></div>'),d=WPTUBE,e=null,f=function(){a(".playlist-items-container").find(".playlist-item").each(function(b,c){a(c).find(".handle").text(++b)})};a(".meta-toolbar-search input").keyup(function(b){var c=a(this).val();a(".playlist-item:not(:contains("+c+"))").hide(),a(".playlist-item:contains("+c+")").show()}),a(".playlist-items-container").sortable({handle:".handle",update:f}),a(".playlist-items-container").find(".playlist-item-remove").click(function(b){b.preventDefault(),a(this).parent().remove()});var g=function(d){var e={id:d.id.videoId,index:b++,title:d.snippet.title,description:d.snippet.description,videoUrl:"https://www.youtube.com/watch?v="+d.id.videoId,channelUrl:"https://www.youtube.com/channel/"+d.snippet.channelId,channelTitle:d.snippet.channelTitle,publishedAt:d.snippet.publishedAt,channelId:d.snippet.channelId,thumbnail:d.snippet.thumbnails.high.url},g=a(c.render(e));g.find(".playlist-item-remove").click(function(b){b.preventDefault(),a(this).parent().remove()}),a(".playlist-items-container").append(g),f()};a("#wt-open-frame").click(function(a){a.preventDefault(),e||(e=new window.WPTubeFrame({key:d.key,restrict:["video"],embedOptions:!1,onSelect:g})),e.open()})}if(a("#wt-playlist-shortcode").length){var h=(a("#post_ID").val(),a("#wt-playlist-shortcode").find(".shortcode-result")),i=a("#wt-playlist-shortcode").find(".shortcode-options");i.find(":input").change(function(a){return l(j())});var j=function(){return k().join(" ")},k=function(){return i.serializeArray().filter(function(a){return a.value}).map(function(a){return a.name+'="'+a.value+'"'})},l=function(a){var b="[playlist "+a+"][/playlist]";h.find("code").text(b)};l(j())}})}(jQuery),function(a){"use strict";var b=function(b){if(!gapi||!window.gapi)return void console.warn("Press Tube","The Google Api script was not loaded, impossible to start the video frame.");var c=this,d=a.extend({key:"",maxResults:10,restrict:null,embedOptions:!0,onSelect:null,insertText:"Insert into post"},b||{}),e=a.templates('<h2>Video Details</h2><div class="attachment-info frame-wrapper"><iframe id="wt-video-preview" width="250" height="200" src="{{:resultEmbed}}"></iframe></div><div class="attachment-data"><h3><a href="{{:resultUrl}}" target="_blank">{{:resultTitle}}</a></h3><h4><a href="{{:channelUrl}}" target="_blank">{{:channelTitle}}</a><span> - {{:publishedAt}}</span></h4><p>{{:resultDescription}}</p></div>{{if embedOptions}}<div class="attachment-options"><h3>Embed options</h3><form class="embed-options"><p><label><input name="controls" type="checkbox" value="0" />Hide Controls</label></p><p><label><input name="fs" type="checkbox" value="0" />Hide Fullscreen</label></p><p><label><input name="loop" type="checkbox" value="1" />Enable loop</label></p><p><label><input name="modestbranding" type="checkbox" value="1" />Modest Branding</label></p><p><label><input name="rel" type="checkbox" value="0" />Hide Relateds</label></p><p><label><input name="showinfo" type="checkbox" value="0" />Hide Info</label></p></form>{{/if}}</div>'),f=a.templates('<div id="wt-frame"><div class="video-modal wp-core-ui"><button type="button" class="button-link media-modal-close"><span class="media-modal-icon"><span class="screen-reader-text">Close</span></span></button><div class="media-modal-content"><div class="media-frame-title"><h1>Insert Videos<span class="dashicons dashicons-arrow-down"></span></h1></div><div class="media-frame-router"><div class="media-router"><a href="#" data-value="video" class="media-menu-item video active">Videos</a><a href="#" data-value="playlist" class="media-menu-item playlist">Playlists</a> <a href="#" data-value="channel" class="media-menu-item channel">Channels</a> </div><a href="#!" class="expand-details" title="Toggle">Enlarge</a></div><div class="media-frame-content"><div class="media-toolbar"><div class="media-toolbar-search"><input id="wt-youtube-input" type="text" placeholder="Search something.." /><button id="wt-youtube-search"></button></div><div class="media-toolbar-view"><button class="button grid"><span class="wp-media-buttons-icon dashicons dashicons-grid-view"></button><button class="button list active"><span class="wp-media-buttons-icon dashicons dashicons-list-view"></button></div></div><div id="wt-youtube-results" class="media-content list-view"></div><div class="media-sidebar"><div class="attachment-details save-ready"></div></div></div><div class="media-frame-toolbar"><div class="media-notify" style="display: none"><span class="dashicons dashicons-yes"></span>Video added</div><div class="media-actions"><button id="wt-add-video" class="button media-button button-primary button-large" style="display: none">Insert into post</button></div></div><div class="media-frame mode-select wp-core-ui"></div></div></div><div class="video-modal-backdrop"></div></div>'),g=a.templates('<div class="video-result" data-result-id="{{:id}}"><div class="video-container"><div class="video-thumbnail"><img src="{{:thumbnail}}" alt="{{:title}}" /></div><div class="video-details"><div class="video-btn"><button class="video-add">ADD</button></div><div class="video-title"><h3>{{:title}}</h3><p><span class="video-channel-title">{{:channelTitle}}</span> - <span class="video-date">{{:publishedAt}}</span></p></div><div class="video-description"><p>{{:description}}</p></div></div></div></div>'),h=a.templates('<div class="frame-wrapper"><iframe width="{{:width}}" height="{{:height}}" src="{{:url}}" frameborder="0" allowfullscreen></iframe></div>'),i=a(f.render({restrict:d.restrict})).hide(),j="video",k=i.find("#wt-add-video").hide(),l=i.find("#wt-youtube-input"),m=i.find("#wt-youtube-search"),n=i.find("#wt-youtube-results"),o=i.find(".media-sidebar"),p=i.find("#wt-video-preview"),q=null,r=!1,s={},t=function(b){s=a.extend({pageToken:b.nextPageToken},s)},u=function(a,b){var c;switch(b){case"video":c="https://www.youtube.com/watch?v="+a;break;case"playlist":c="https://www.youtube.com/playlist?list="+a}return c},v=function(b,c){if((b=b?b:q)&&d.onSelect&&a.isFunction(d.onSelect)){var e=z(b,j,c);return b=a.extend({},{embedurl:e,watchurl:e,iframe:A(e)},b||{}),i.find(".media-notify").show().delay(2500).fadeOut(),d.onSelect(b)}},w=function(a){return"https://www.youtube.com/channel/"+a},x=function(b){var c=D(b),f=b.id.kind.replace("youtube#",""),g={id:c,resultTitle:b.snippet.title,resultDescription:b.snippet.description,resultUrl:u(c,f),resultEmbed:z(b,f,{fs:0,rel:0,showinfo:0}),channelTitle:b.snippet.channelTitle,channelUrl:w(b.snippet.channelId),publishedAt:new Date(Date.parse(b.snippet.publishedAt)).toUTCString(),embedOptions:d.embedOptions},h=a(e.render(g));i.find(".attachment-details").empty().append(h),k.show()},y=function(){return{q:l.val(),part:"snippet",type:j,maxResults:20}},z=function(b,c,d){d=d||{};var e="https://www.youtube.com/embed/";switch(c){case"video":e+=b.id.videoId;break;case"playlist":d.listType="playlist",d.list=b.id.playlistId;break;case"channel":}var f=d?a.param(d):null;return f&&(e+="?"+f),e},A=function(a){return h.render({width:560,height:315,url:a})},B=function(b){var c=[];a.each(b,function(b,d){var e={id:D(d),title:d.snippet.title,description:d.snippet.description,thumbnail:d.snippet.thumbnails?d.snippet.thumbnails.medium.url:"",channelTitle:d.snippet.channelTitle,publishedAt:new Date(Date.parse(d.snippet.publishedAt)).toUTCString()},f=a(g.render(e));f.find(".video-thumbnail, .video-title").click(function(a){a.preventDefault(),q=d,x(d)}),f.find(".video-add").click(function(a){a.preventDefault(),v(d)}),c.push(f)}),n.append(c)},C=function(){q=null,n.empty(),l.val(""),i.find(".attachment-details").empty()},D=function(a){var b;switch(a.id.kind){case"youtube#video":b=a.id.videoId;break;case"youtube#playlist":b=a.id.playlistId}return b};return this.search=function(){s=y(),gapi.client.youtube.search.list(s).execute(function(a){t(a),n.empty(),a.result&&a.result.items.length&&(B(a.items),n.animate({scrollTop:0},"slow"))})},this.open=function(){i.show()},this.close=function(){C(),i.hide()},gapi.load("client",function(){gapi.client.init({apiKey:d.key}).then(function(){gapi.client.load("youtube","v3").then(function(){j="video",k=i.find("#wt-add-video").hide(),l=i.find("#wt-youtube-input"),m=i.find("#wt-youtube-search"),n=i.find("#wt-youtube-results"),o=i.find(".media-sidebar"),p=i.find("#wt-video-preview"),q=null,r=!1,s={},i.find(".media-modal-close").click(c.close),i.find(".video-modal-backdrop").click(c.close),i.find(".media-toolbar-view .grid").click(function(b){b.preventDefault(),n.removeClass("list-view").addClass("grid-view"),a(this).siblings().removeClass("active"),a(this).addClass("active")}),i.find(".media-toolbar-view .list").click(function(b){b.preventDefault(),n.removeClass("grid-view").addClass("list-view"),a(this).siblings().removeClass("active"),a(this).addClass("active")}),d.restrict&&(i.find(".media-router .media-menu-item").hide(),a.each(d.restrict,function(a,b){i.find(".media-router .media-menu-item."+b).show()})),i.find(".media-router .media-menu-item").click(function(b){b.preventDefault(),a(this).siblings().removeClass("active"),a(this).addClass("active"),j=a(this).data("value"),""!==l.val()&&c.search()}),i.find(".expand-details").click(function(b){a(this).text("Enlarge"==a(this).text()?"Reduce":"Enlarge"),i.find(".video-modal").toggleClass("expanded")}),n.on("scroll",function(){if(!r&&a(this).scrollTop()+a(this).innerHeight()>=a(this)[0].scrollHeight){r=!0;gapi.client.youtube.search.list(s).execute(function(a){r=!1,t(a),a.result&&a.result.items.length&&B(a.items)})}}),l.keyup(function(a){13===a.which&&(a.preventDefault(),c.search())}),m.click(function(a){a.preventDefault(),c.search()}),k.click(function(a){a.preventDefault(),v(null,i.find("form.embed-options").serializeArray()),c.close()}),a("body").append(i)})})}),this};window.WPTubeFrame=b}(jQuery);